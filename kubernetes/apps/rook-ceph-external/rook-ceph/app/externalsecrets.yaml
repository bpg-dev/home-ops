---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: rook-ceph-mon
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    creationPolicy: Owner
  data:
  - secretKey: admin-secret
    remoteRef:
      key: rook-ceph/admin-secret
  - secretKey: mon-secret
    remoteRef:
      key: rook-ceph/mon-secret
  - secretKey: ceph-secret
    remoteRef:
      key: rook-ceph/ceph-secret
  - secretKey: ceph-username
    remoteRef:
      key: rook-ceph/ceph-username
  - secretKey: cluster-name
    remoteRef:
      key: rook-ceph/cluster-name
  - secretKey: fsid
    remoteRef:
      key: rook-ceph/fsid
  # Refresh interval: 4h (staggered to avoid simultaneous refreshes)
  # 1Password Families: 1,000 reads/hour, 1,000 total/day per account
  refreshInterval: 4h
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: rook-csi-cephfs-node
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    creationPolicy: Owner
  data:
  - secretKey: userID
    remoteRef:
      key: rook-ceph/csi-cephfs-node-userID
  - secretKey: userKey
    remoteRef:
      key: rook-ceph/csi-cephfs-node-userKey
  # Refresh interval: 4h15m (staggered)
  refreshInterval: 4h15m
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: rook-csi-cephfs-provisioner
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    creationPolicy: Owner
  data:
  - secretKey: userID
    remoteRef:
      key: rook-ceph/csi-cephfs-provisioner-userID
  - secretKey: userKey
    remoteRef:
      key: rook-ceph/csi-cephfs-provisioner-userKey
  # Refresh interval: 4h30m (staggered)
  refreshInterval: 4h30m
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: rook-csi-rbd-node
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    creationPolicy: Owner
  data:
  - secretKey: userID
    remoteRef:
      key: rook-ceph/csi-rbd-node-userID
  - secretKey: userKey
    remoteRef:
      key: rook-ceph/csi-rbd-node-userKey
  # Refresh interval: 4h45m (staggered)
  refreshInterval: 4h45m
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: rook-csi-rbd-provisioner
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    creationPolicy: Owner
  data:
  - secretKey: userID
    remoteRef:
      key: rook-ceph/csi-rbd-provisioner-userID
  - secretKey: userKey
    remoteRef:
      key: rook-ceph/csi-rbd-provisioner-userKey
  # Refresh interval: 5h (staggered)
  refreshInterval: 5h

